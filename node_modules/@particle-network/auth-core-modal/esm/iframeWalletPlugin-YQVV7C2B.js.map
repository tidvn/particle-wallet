{
  "version": 3,
  "sources": ["../src/context/iframeWalletPlugin.tsx"],
  "sourcesContent": ["import { AuthCoreEvent, getUserInfo, isConnected } from '@particle-network/auth-core';\nimport { walletEntryPlugin } from '@particle-network/wallet';\nimport React, { useCallback, useEffect } from 'react';\nimport { useModalOptions } from '.';\nimport { useAuthCore, useConnect, useEthereum, useSolana } from './hooks';\n\nenum MessageType {\n    OpenAccountAndSecurity = 'open-account-and-security',\n    GetUserInfo = 'get-user-info',\n}\n\nconst IframeWalletPlugin = () => {\n    const { provider } = useEthereum();\n\n    const { wallet } = useSolana();\n\n    const { openAccountAndSecurity } = useAuthCore();\n\n    const { modalOptions } = useModalOptions();\n\n    const { connected } = useConnect();\n\n    const customEventHandler = useCallback(\n        async (messageType: string) => {\n            if (messageType === MessageType.OpenAccountAndSecurity) {\n                openAccountAndSecurity();\n            } else if (messageType === MessageType.GetUserInfo) {\n                return getUserInfo();\n            }\n        },\n        [openAccountAndSecurity]\n    );\n\n    useEffect(() => {\n        const walletOptions = {\n            ...modalOptions.wallet,\n            erc4337: modalOptions.erc4337,\n            language: modalOptions.language,\n        };\n\n        walletEntryPlugin.init(\n            {\n                projectId: modalOptions.projectId,\n                clientKey: modalOptions.clientKey,\n                appId: modalOptions.appId,\n            },\n            walletOptions\n        );\n        const onConnected = () => {\n            walletEntryPlugin.walletEntryCreate();\n        };\n        const onDisconnect = () => {\n            walletEntryPlugin.walletEntryDestroy();\n        };\n        if (typeof window !== 'undefined') {\n            window.particleAuth?.on(AuthCoreEvent.ParticleAuthDisconnect, onDisconnect);\n            window.particleAuth?.on(AuthCoreEvent.ParticleAuthConnect, onConnected);\n        }\n        if (isConnected()) {\n            walletEntryPlugin.walletEntryCreate();\n        }\n        return () => {\n            if (typeof window !== 'undefined') {\n                window.particleAuth?.off(AuthCoreEvent.ParticleAuthDisconnect, onDisconnect);\n                window.particleAuth?.off(AuthCoreEvent.ParticleAuthConnect, onConnected);\n            }\n        };\n    }, [\n        modalOptions.projectId,\n        modalOptions.clientKey,\n        modalOptions.appId,\n        modalOptions.wallet,\n        modalOptions.erc4337,\n        modalOptions.language,\n    ]);\n\n    useEffect(() => {\n        if (connected) {\n            walletEntryPlugin.setWalletCore(\n                {\n                    ethereum: provider,\n                    solana: wallet,\n                },\n                customEventHandler\n            );\n        }\n    }, [connected, provider, wallet, customEventHandler]);\n\n    return (\n        <div id=\"auth-core-modal-wallet-plugin\" style={{ display: 'none' }}>\n            Wallet Plugin\n        </div>\n    );\n};\n\nexport default IframeWalletPlugin;\n"],
  "mappings": ";;;;;;;;;;;;;;AAAA,SAAS,eAAe,aAAa,mBAAmB;AACxD,SAAS,yBAAyB;AAClC,OAAO,SAAS,aAAa,iBAAiB;AAS9C,IAAM,qBAAqB,MAAM;AAC7B,QAAM,EAAE,SAAS,IAAI,YAAY;AAEjC,QAAM,EAAE,OAAO,IAAI,UAAU;AAE7B,QAAM,EAAE,uBAAuB,IAAI,YAAY;AAE/C,QAAM,EAAE,aAAa,IAAI,gBAAgB;AAEzC,QAAM,EAAE,UAAU,IAAI,WAAW;AAEjC,QAAM,qBAAqB;AAAA,IACvB,OAAO,gBAAwB;AAC3B,UAAI,gBAAgB,0DAAoC;AACpD,+BAAuB;AAAA,MAC3B,WAAW,gBAAgB,mCAAyB;AAChD,eAAO,YAAY;AAAA,MACvB;AAAA,IACJ;AAAA,IACA,CAAC,sBAAsB;AAAA,EAC3B;AAEA,YAAU,MAAM;AAjCpB;AAkCQ,UAAM,gBAAgB;AAAA,MAClB,GAAG,aAAa;AAAA,MAChB,SAAS,aAAa;AAAA,MACtB,UAAU,aAAa;AAAA,IAC3B;AAEA,sBAAkB;AAAA,MACd;AAAA,QACI,WAAW,aAAa;AAAA,QACxB,WAAW,aAAa;AAAA,QACxB,OAAO,aAAa;AAAA,MACxB;AAAA,MACA;AAAA,IACJ;AACA,UAAM,cAAc,MAAM;AACtB,wBAAkB,kBAAkB;AAAA,IACxC;AACA,UAAM,eAAe,MAAM;AACvB,wBAAkB,mBAAmB;AAAA,IACzC;AACA,QAAI,OAAO,WAAW,aAAa;AAC/B,mBAAO,iBAAP,mBAAqB,GAAG,cAAc,wBAAwB;AAC9D,mBAAO,iBAAP,mBAAqB,GAAG,cAAc,qBAAqB;AAAA,IAC/D;AACA,QAAI,YAAY,GAAG;AACf,wBAAkB,kBAAkB;AAAA,IACxC;AACA,WAAO,MAAM;AA7DrB,UAAAA,KAAAC;AA8DY,UAAI,OAAO,WAAW,aAAa;AAC/B,SAAAD,MAAA,OAAO,iBAAP,gBAAAA,IAAqB,IAAI,cAAc,wBAAwB;AAC/D,SAAAC,MAAA,OAAO,iBAAP,gBAAAA,IAAqB,IAAI,cAAc,qBAAqB;AAAA,MAChE;AAAA,IACJ;AAAA,EACJ,GAAG;AAAA,IACC,aAAa;AAAA,IACb,aAAa;AAAA,IACb,aAAa;AAAA,IACb,aAAa;AAAA,IACb,aAAa;AAAA,IACb,aAAa;AAAA,EACjB,CAAC;AAED,YAAU,MAAM;AACZ,QAAI,WAAW;AACX,wBAAkB;AAAA,QACd;AAAA,UACI,UAAU;AAAA,UACV,QAAQ;AAAA,QACZ;AAAA,QACA;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ,GAAG,CAAC,WAAW,UAAU,QAAQ,kBAAkB,CAAC;AAEpD,SACI,oCAAC,SAAI,IAAG,iCAAgC,OAAO,EAAE,SAAS,OAAO,KAAG,eAEpE;AAER;AAEA,IAAO,6BAAQ;",
  "names": ["_a", "_b"]
}
