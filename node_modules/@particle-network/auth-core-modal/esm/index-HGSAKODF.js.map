{
  "version": 3,
  "sources": ["../src/pages/index/index.tsx"],
  "sourcesContent": ["import { isConnected } from '@particle-network/auth-core';\nimport { message } from 'antd';\nimport base64url from 'base64url';\nimport qs from 'qs';\nimport React, { useEffect } from 'react';\nimport { useCustomNavigate, useParticleAuth } from '../../context';\nimport { useConnect } from '../../context/hooks';\nimport { isServer } from '../../utils';\nimport styles from './index.less';\n\nconst Index = () => {\n    const { connect } = useConnect();\n    const navigate = useCustomNavigate();\n    const { setConnectionStatus, socialConnectCallback } = useParticleAuth();\n    const thirdpartyLogin = async () => {\n        try {\n            const query = qs.parse(!isServer() ? window.location.search : '', {\n                ignoreQueryPrefix: true,\n            });\n            const particleThirdpartyParamsContent = query?.particleThirdpartyParams as string;\n            if (!particleThirdpartyParamsContent) {\n                if (!isConnected()) {\n                    setConnectionStatus('disconnected');\n                }\n                return;\n            }\n\n            delete query.particleThirdpartyParams;\n            const replaceUrl = (window.location.origin + window.location.pathname + '?' + qs.stringify(query)).replace(\n                /\\?$/,\n                ''\n            );\n            window.history.replaceState({}, document.title, replaceUrl);\n            document.title = document.title || replaceUrl;\n\n            const particleThirdpartyParams = JSON.parse(base64url.decode(particleThirdpartyParamsContent as string));\n            const { code, nonce, appState, error } = particleThirdpartyParams;\n            const appStateObj = appState ? JSON.parse(base64url.decode(appState as string)) : {};\n            const { authorization, chain, purpose, verifyToken } = appStateObj;\n\n            if (error) {\n                if (!isConnected()) {\n                    setConnectionStatus('disconnected');\n                }\n                if (!purpose) {\n                    socialConnectCallback?.onError?.(new Error(error));\n                } else {\n                    message.error(error);\n                }\n                return;\n            }\n\n            const authType = nonce.split('@')[0];\n\n            if (purpose === 'bindLoginAccount') {\n                navigate('/login-account/bind-loading', {\n                    state: {\n                        authType,\n                        verifyToken,\n                        code,\n                        nonce,\n                    },\n                    replace: true,\n                });\n            } else {\n                await new Promise((resolve) => {\n                    setTimeout(() => {\n                        resolve(true);\n                    }, 20);\n                });\n                await connect({ socialType: authType, code, nonce, authorization, chain });\n            }\n        } catch (error: any) {\n            console.error('after redirect, login or bind', error);\n            if (!isConnected()) {\n                setConnectionStatus('disconnected');\n            }\n        }\n    };\n\n    useEffect(() => {\n        thirdpartyLogin();\n    }, []);\n\n    return (\n        <div className=\"index-container\">\n            <style>{styles as unknown as string}</style>\n        </div>\n    );\n};\n\nexport default Index;\n"],
  "mappings": ";;;;;;;;;;;;;AAAA,SAAS,mBAAmB;AAC5B,SAAS,eAAe;AACxB,OAAO,eAAe;AACtB,OAAO,QAAQ;AACf,OAAO,SAAS,iBAAiB;;;;;;AAMjC,IAAM,QAAQ,MAAM;AAChB,QAAM,EAAE,QAAQ,IAAI,WAAW;AAC/B,QAAM,WAAW,kBAAkB;AACnC,QAAM,EAAE,qBAAqB,sBAAsB,IAAI,gBAAgB;AACvE,QAAM,kBAAkB,YAAY;AAdxC;AAeQ,QAAI;AACA,YAAM,QAAQ,GAAG,MAAM,CAAC,SAAS,IAAI,OAAO,SAAS,SAAS,IAAI;AAAA,QAC9D,mBAAmB;AAAA,MACvB,CAAC;AACD,YAAM,kCAAkC,+BAAO;AAC/C,UAAI,CAAC,iCAAiC;AAClC,YAAI,CAAC,YAAY,GAAG;AAChB,8BAAoB,cAAc;AAAA,QACtC;AACA;AAAA,MACJ;AAEA,aAAO,MAAM;AACb,YAAM,cAAc,OAAO,SAAS,SAAS,OAAO,SAAS,WAAW,MAAM,GAAG,UAAU,KAAK,GAAG;AAAA,QAC/F;AAAA,QACA;AAAA,MACJ;AACA,aAAO,QAAQ,aAAa,CAAC,GAAG,SAAS,OAAO,UAAU;AAC1D,eAAS,QAAQ,SAAS,SAAS;AAEnC,YAAM,2BAA2B,KAAK,MAAM,UAAU,OAAO,+BAAyC,CAAC;AACvG,YAAM,EAAE,MAAM,OAAO,UAAU,MAAM,IAAI;AACzC,YAAM,cAAc,WAAW,KAAK,MAAM,UAAU,OAAO,QAAkB,CAAC,IAAI,CAAC;AACnF,YAAM,EAAE,eAAe,OAAO,SAAS,YAAY,IAAI;AAEvD,UAAI,OAAO;AACP,YAAI,CAAC,YAAY,GAAG;AAChB,8BAAoB,cAAc;AAAA,QACtC;AACA,YAAI,CAAC,SAAS;AACV,+EAAuB,YAAvB,+CAAiC,IAAI,MAAM,KAAK;AAAA,QACpD,OAAO;AACH,kBAAQ,MAAM,KAAK;AAAA,QACvB;AACA;AAAA,MACJ;AAEA,YAAM,WAAW,MAAM,MAAM,GAAG,EAAE;AAElC,UAAI,YAAY,oBAAoB;AAChC,iBAAS,+BAA+B;AAAA,UACpC,OAAO;AAAA,YACH;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACJ;AAAA,UACA,SAAS;AAAA,QACb,CAAC;AAAA,MACL,OAAO;AACH,cAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,qBAAW,MAAM;AACb,oBAAQ,IAAI;AAAA,UAChB,GAAG,EAAE;AAAA,QACT,CAAC;AACD,cAAM,QAAQ,EAAE,YAAY,UAAU,MAAM,OAAO,eAAe,MAAM,CAAC;AAAA,MAC7E;AAAA,IACJ,SAAS,OAAP;AACE,cAAQ,MAAM,iCAAiC,KAAK;AACpD,UAAI,CAAC,YAAY,GAAG;AAChB,4BAAoB,cAAc;AAAA,MACtC;AAAA,IACJ;AAAA,EACJ;AAEA,YAAU,MAAM;AACZ,oBAAgB;AAAA,EACpB,GAAG,CAAC,CAAC;AAEL,SACI,oCAAC,SAAI,WAAU,qBACX,oCAAC,eAAO,aAA4B,CACxC;AAER;AAEA,IAAOA,iBAAQ;",
  "names": ["index_default"]
}
